<!DOCTYPE html>
<html lang="ms">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Raya Brand AR Filter - Absolut Bazaar</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #000;
            font-family: 'Helvetica Neue', Arial, sans-serif;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        /* Camera Container */
        #camera-container {
            position: relative;
            width: 100%;
            max-width: 450px;
            height: 100%;
            background: #000;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }

        video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transform: scaleX(-1);
        }

        /* AR Card Design - Raya Themed */
        #ar-card {
            position: absolute;
            top: 12%;
            left: 50%;
            transform: translateX(-50%);
            width: 280px;
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.98), rgba(0, 166, 81, 0.98));
            border-radius: 20px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4), 0 0 0 4px rgba(255, 255, 255, 0.3);
            border: 5px solid #FFD700;
            z-index: 10;
            backdrop-filter: blur(10px);
        }

        .card-header {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: #000;
            margin-bottom: 8px;
            font-weight: 900;
            text-shadow: 0 1px 2px rgba(255, 255, 255, 0.5);
        }

        .raya-greeting {
            font-size: 14px;
            color: #8B0000;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 0 1px 3px rgba(255, 255, 255, 0.7);
        }

        #result-text {
            font-size: 28px;
            font-weight: 900;
            color: #8B0000;
            min-height: 70px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            line-height: 1.2;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            background: rgba(255, 255, 255, 0.9);
            border-radius: 12px;
            padding: 10px;
            margin: 10px 0;
        }

        .brand-icon {
            font-size: 40px;
            margin-bottom: 5px;
        }

        /* Decorative Elements */
        .ketupat-deco {
            position: absolute;
            font-size: 30px;
            animation: swing 3s ease-in-out infinite;
        }

        .ketupat-left {
            top: -15px;
            left: -15px;
        }

        .ketupat-right {
            top: -15px;
            right: -15px;
        }

        @keyframes swing {

            0%,
            100% {
                transform: rotate(-10deg);
            }

            50% {
                transform: rotate(10deg);
            }
        }

        /* Control Buttons Container */
        .controls-container {
            position: absolute;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 20px;
            z-index: 20;
        }

        /* Record Button */
        #record-btn {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background-color: white;
            border: 5px solid rgba(255, 255, 255, 0.4);
            cursor: pointer;
            transition: transform 0.1s;
            position: relative;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        #record-btn:active {
            transform: scale(0.9);
            background-color: #ddd;
        }

        #record-btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 50px;
            height: 50px;
            background: #D32F2F;
            border-radius: 50%;
        }

        #record-btn.recording::after {
            animation: recording-pulse 1s ease-in-out infinite;
        }

        @keyframes recording-pulse {

            0%,
            100% {
                transform: translate(-50%, -50%) scale(1);
            }

            50% {
                transform: translate(-50%, -50%) scale(1.1);
            }
        }

        /* Spin Button */
        #spin-btn {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(135deg, #FFD700, #00A651);
            border: 5px solid rgba(255, 215, 0, 0.6);
            cursor: pointer;
            transition: transform 0.1s;
            position: relative;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
        }

        #spin-btn:active {
            transform: scale(0.9);
        }

        #spin-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Animation Classes */
        .pulse {
            animation: pulse-animation 0.5s ease-in-out;
        }

        @keyframes pulse-animation {
            0% {
                transform: translateX(-50%) scale(1);
            }

            50% {
                transform: translateX(-50%) scale(1.15);
            }

            100% {
                transform: translateX(-50%) scale(1);
            }
        }

        /* Instructions Overlay */
        .instructions {
            position: absolute;
            top: 50%;
            width: 100%;
            text-align: center;
            color: white;
            pointer-events: none;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.9);
            font-weight: bold;
            font-size: 16px;
            z-index: 15;
        }

        /* Top UI */
        .top-ui {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.7);
            padding: 10px 20px;
            border-radius: 25px;
            color: white;
            font-size: 14px;
            font-weight: bold;
            z-index: 10;
            backdrop-filter: blur(10px);
        }

        /* Recording Indicator */
        .recording-indicator {
            position: absolute;
            top: 20px;
            left: 20px;
            background: #D32F2F;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            display: none;
            align-items: center;
            gap: 8px;
            z-index: 10;
        }

        .recording-indicator.active {
            display: flex;
        }

        .rec-dot {
            width: 10px;
            height: 10px;
            background: white;
            border-radius: 50%;
            animation: blink 1s infinite;
        }

        @keyframes blink {

            0%,
            50% {
                opacity: 1;
            }

            51%,
            100% {
                opacity: 0;
            }
        }

        /* Countdown */
        .countdown {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 100px;
            font-weight: 900;
            color: white;
            text-shadow: 0 4px 20px rgba(0, 0, 0, 0.8);
            z-index: 100;
            display: none;
        }

        .countdown.active {
            display: block;
            animation: countdown-pop 1s ease-out;
        }

        @keyframes countdown-pop {
            0% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 0;
            }

            50% {
                transform: translate(-50%, -50%) scale(1.2);
                opacity: 1;
            }

            100% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }
        }

        /* Button Labels */
        .button-label {
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 10px;
            color: white;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.8);
            font-weight: bold;
            white-space: nowrap;
        }
    </style>
</head>

<body>

    <div id="camera-container">
        <video id="video" autoplay playsinline></video>

        <!-- Top UI -->
        <div class="top-ui">üåô RAYA BRAND FILTER 2025</div>

        <!-- Recording Indicator -->
        <div class="recording-indicator" id="recordingIndicator">
            <div class="rec-dot"></div>
            RECORDING
        </div>

        <!-- Countdown -->
        <div class="countdown" id="countdown"></div>

        <!-- AR Card -->
        <div id="ar-card">
            <div class="ketupat-deco ketupat-left">üéä</div>
            <div class="ketupat-deco ketupat-right">üéä</div>

            <div class="card-header">üåô SELAMAT HARI RAYA üåô</div>
            <div class="raya-greeting">Brand Pilihan Anda:</div>

            <div id="result-text">
                <div class="brand-icon">üéÅ</div>
                <div>???</div>
            </div>

            <div style="font-size: 10px; color: #000; margin-top: 8px; font-weight: bold;">
                Powered by Absolut Bazaar
            </div>
        </div>

        <!-- Instructions -->
        <div class="instructions" id="instruction-text">
            üé• Tekan butang MERAH untuk mula rakam<br>
            üåô Tekan butang EMAS untuk spin brand!
        </div>

        <!-- Control Buttons -->
        <div class="controls-container">
            <!-- Record Button -->
            <div style="position: relative;">
                <div id="record-btn"></div>
                <div class="button-label">RAKAM</div>
            </div>

            <!-- Spin Button -->
            <div style="position: relative;">
                <div id="spin-btn">üåô</div>
                <div class="button-label">SPIN</div>
            </div>
        </div>
    </div>

    <script>
        // ==================== GLOBAL STATE ====================
        const brands = [
            { name: "Elrah", icon: "üëî", color: "#8B4513" },
            { name: "Bulan Bintang", icon: "üåô", color: "#FFD700" },
            { name: "Rizman Ruzaini", icon: "‚ú®", color: "#4A148C" },
            { name: "Fiziwoo", icon: "üé©", color: "#00A651" },
            { name: "Jakel", icon: "üèõÔ∏è", color: "#D32F2F" },
            { name: "Pesona Pengantin", icon: "üíç", color: "#0066CC" },
            { name: "Fairuz Ramdan", icon: "üé≠", color: "#FF6B00" },
            { name: "TAK PUASA", icon: "‚ùå", color: "#666666" }
        ];

        let isSpinning = false;
        let isRecording = false;
        let mediaRecorder = null;
        let recordedChunks = [];
        let canvasStream = null;

        // ==================== CAMERA SETUP ====================
        const video = document.getElementById('video');
        let cameraStream = null;

        async function initCamera() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({
                    video: {
                        facingMode: 'user',
                        width: { ideal: 1280 },
                        height: { ideal: 720 }
                    },
                    audio: false
                });

                video.srcObject = stream;
                cameraStream = stream;

                // Wait for video to be ready
                video.onloadedmetadata = () => {
                    video.play().then(() => {
                        setupCanvas();
                        console.log('‚úÖ Camera ready!');
                    }).catch(err => {
                        console.error('Video play error:', err);
                    });
                };

            } catch (error) {
                console.error("Camera error:", error);
                alert('‚ö†Ô∏è Kamera diperlukan untuk AR Filter!\n\nSila benarkan akses kamera dan refresh page.');
                document.getElementById('result-text').innerHTML =
                    '<div class="brand-icon">‚ö†Ô∏è</div><div>Camera Error</div>';
            }
        }

        // Initialize camera on page load
        initCamera();

        // ==================== CANVAS SETUP FOR RECORDING WITH AR ====================
        let canvas, ctx;

        function setupCanvas() {
            // Create a hidden canvas to combine video + AR overlay
            canvas = document.createElement('canvas');
            canvas.width = video.videoWidth || 1280;
            canvas.height = video.videoHeight || 720;
            ctx = canvas.getContext('2d');

            // Create stream from canvas
            canvasStream = canvas.captureStream(30); // 30 FPS
        }

        function drawFrame() {
            if (!canvas || !ctx) return;

            // Draw video frame (mirrored)
            ctx.save();
            ctx.scale(-1, 1);
            ctx.drawImage(video, -canvas.width, 0, canvas.width, canvas.height);
            ctx.restore();

            // Draw AR overlay elements
            drawAROverlay();

            if (isRecording) {
                requestAnimationFrame(drawFrame);
            }
        }

        function drawAROverlay() {
            const scale = canvas.width / 450; // Scale based on canvas size

            // Get current AR card state
            const cardEl = document.getElementById('ar-card');
            const resultTextEl = document.getElementById('result-text');
            const topUIEl = document.querySelector('.top-ui');
            const recordingIndEl = document.getElementById('recordingIndicator');
            const countdownElVisible = document.getElementById('countdown');

            // Draw Top UI
            ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
            ctx.fillRect(canvas.width / 2 - 150 * scale, 20 * scale, 300 * scale, 40 * scale);
            ctx.font = `bold ${14 * scale}px Arial`;
            ctx.fillStyle = 'white';
            ctx.textAlign = 'center';
            ctx.fillText('üåô RAYA BRAND FILTER 2025', canvas.width / 2, 45 * scale);

            // Draw Recording Indicator if active
            if (recordingIndEl.classList.contains('active')) {
                ctx.fillStyle = '#D32F2F';
                ctx.fillRect(20 * scale, 20 * scale, 100 * scale, 30 * scale);
                ctx.beginPath();
                ctx.arc(40 * scale, 35 * scale, 5 * scale, 0, 2 * Math.PI);
                ctx.fillStyle = 'white';
                ctx.fill();
                ctx.font = `bold ${12 * scale}px Arial`;
                ctx.fillText('RECORDING', 85 * scale, 40 * scale);
            }

            // Draw Countdown if visible
            if (countdownElVisible.classList.contains('active')) {
                ctx.font = `bold ${100 * scale}px Arial`;
                ctx.fillStyle = 'white';
                ctx.shadowColor = 'rgba(0, 0, 0, 0.8)';
                ctx.shadowBlur = 20 * scale;
                ctx.textAlign = 'center';
                ctx.fillText(countdownElVisible.textContent, canvas.width / 2, canvas.height / 2);
                ctx.shadowBlur = 0;
            }

            // Draw AR Card
            const cardX = canvas.width / 2 - 140 * scale;
            const cardY = canvas.height * 0.12;
            const cardWidth = 280 * scale;
            const cardHeight = 180 * scale;

            // Get current card background color from style
            const cardStyle = window.getComputedStyle(cardEl);
            const cardBg = cardStyle.background || 'linear-gradient(135deg, rgba(255, 215, 0, 0.98), rgba(0, 166, 81, 0.98))';

            // Draw card background (simplified gradient)
            const gradient = ctx.createLinearGradient(cardX, cardY, cardX + cardWidth, cardY + cardHeight);

            // Parse current brand color
            const currentBrandMatch = resultTextEl.innerHTML.match(/brand-icon">([^<]+)</);
            let brandColor = '#FFD700';
            if (currentBrandMatch) {
                const brandIcon = currentBrandMatch[1];
                const brand = brands.find(b => b.icon === brandIcon);
                if (brand) {
                    brandColor = brand.color;
                }
            }

            gradient.addColorStop(0, brandColor + 'dd');
            gradient.addColorStop(1, brandColor + '99');
            ctx.fillStyle = gradient;

            // Draw rounded rectangle
            roundRect(ctx, cardX, cardY, cardWidth, cardHeight, 20 * scale);
            ctx.fill();

            // Draw card border
            ctx.strokeStyle = '#FFD700';
            ctx.lineWidth = 5 * scale;
            roundRect(ctx, cardX, cardY, cardWidth, cardHeight, 20 * scale);
            ctx.stroke();

            // Draw ketupat decorations
            ctx.font = `${30 * scale}px Arial`;
            ctx.fillText('üéä', cardX - 5 * scale, cardY + 15 * scale);
            ctx.fillText('üéä', cardX + cardWidth - 10 * scale, cardY + 15 * scale);

            // Draw card content
            ctx.fillStyle = 'black';
            ctx.font = `bold ${11 * scale}px Arial`;
            ctx.textAlign = 'center';
            ctx.fillText('üåô SELAMAT HARI RAYA üåô', cardX + cardWidth / 2, cardY + 30 * scale);

            ctx.font = `bold ${14 * scale}px Arial`;
            ctx.fillText('Brand Pilihan Anda:', cardX + cardWidth / 2, cardY + 50 * scale);

            // Draw result box background
            ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';
            roundRect(ctx, cardX + 20 * scale, cardY + 60 * scale, cardWidth - 40 * scale, 70 * scale, 12 * scale);
            ctx.fill();

            // Draw brand icon and name
            const brandIconMatch = resultTextEl.innerHTML.match(/brand-icon">([^<]+)</);
            const brandNameMatch = resultTextEl.innerHTML.match(/<div>([^<]+)<\/div>/);

            if (brandIconMatch) {
                ctx.font = `${40 * scale}px Arial`;
                ctx.fillText(brandIconMatch[1], cardX + cardWidth / 2, cardY + 95 * scale);
            }

            if (brandNameMatch) {
                ctx.fillStyle = '#8B0000';
                ctx.font = `bold ${24 * scale}px Arial`;
                ctx.shadowColor = 'rgba(0, 0, 0, 0.3)';
                ctx.shadowBlur = 4 * scale;
                ctx.fillText(brandNameMatch[1], cardX + cardWidth / 2, cardY + 125 * scale);
                ctx.shadowBlur = 0;
            }

            // Draw "Powered by" text
            ctx.fillStyle = 'black';
            ctx.font = `bold ${10 * scale}px Arial`;
            ctx.fillText('Powered by Absolut Bazaar', cardX + cardWidth / 2, cardY + 150 * scale);

            // Reset text align
            ctx.textAlign = 'left';
        }

        function roundRect(ctx, x, y, width, height, radius) {
            ctx.beginPath();
            ctx.moveTo(x + radius, y);
            ctx.lineTo(x + width - radius, y);
            ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
            ctx.lineTo(x + width, y + height - radius);
            ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
            ctx.lineTo(x + radius, y + height);
            ctx.quadraticCurveTo(x, y + height, x, y + height - radius);
            ctx.lineTo(x, y + radius);
            ctx.quadraticCurveTo(x, y, x + radius, y);
            ctx.closePath();
        }

        // ==================== ELEMENTS ====================
        const recordBtn = document.getElementById('record-btn');
        const spinBtn = document.getElementById('spin-btn');
        const resultDisplay = document.getElementById('result-text');
        const card = document.getElementById('ar-card');
        const instructions = document.getElementById('instruction-text');
        const recordingIndicator = document.getElementById('recordingIndicator');
        const countdownEl = document.getElementById('countdown');

        // ==================== RECORD BUTTON ====================
        recordBtn.addEventListener('click', () => {
            if (!isRecording) {
                startRecording();
            } else {
                stopRecording();
            }
        });

        function startRecording() {
            if (!canvasStream) {
                alert('‚ö†Ô∏è Camera not ready! Please wait a moment.');
                return;
            }

            try {
                // Setup media recorder with canvas stream (includes AR overlay)
                const options = { mimeType: 'video/webm;codecs=vp9' };

                // Fallback for iOS
                if (!MediaRecorder.isTypeSupported(options.mimeType)) {
                    options.mimeType = 'video/webm';
                    if (!MediaRecorder.isTypeSupported(options.mimeType)) {
                        options.mimeType = 'video/mp4';
                    }
                }

                mediaRecorder = new MediaRecorder(canvasStream, options);
                recordedChunks = [];

                mediaRecorder.ondataavailable = (event) => {
                    if (event.data.size > 0) {
                        recordedChunks.push(event.data);
                    }
                };

                mediaRecorder.onstop = () => {
                    const blob = new Blob(recordedChunks, { type: 'video/webm' });
                    const url = URL.createObjectURL(blob);

                    // Download the video
                    const a = document.createElement('a');
                    a.style.display = 'none';
                    a.href = url;
                    a.download = `raya-brand-${Date.now()}.webm`;
                    document.body.appendChild(a);
                    a.click();

                    setTimeout(() => {
                        document.body.removeChild(a);
                        URL.revokeObjectURL(url);
                    }, 100);

                    alert('‚úÖ Video dengan AR overlay saved! Share to Instagram/TikTok dengan hashtag #RayaWithAbsolutBazaar');
                };

                mediaRecorder.start();
                isRecording = true;
                recordBtn.classList.add('recording');
                recordingIndicator.classList.add('active');
                instructions.style.display = 'none';

                // Start drawing frames
                drawFrame();

            } catch (error) {
                console.error('Recording error:', error);
                alert('‚ö†Ô∏è Recording not supported on this browser. Try Chrome or Safari on desktop.');
            }
        }

        function stopRecording() {
            if (mediaRecorder && mediaRecorder.state !== 'inactive') {
                mediaRecorder.stop();
                isRecording = false;
                recordBtn.classList.remove('recording');
                recordingIndicator.classList.remove('active');
                instructions.innerHTML = "‚úÖ Video saved dengan AR overlay!<br>üé∞ Spin lagi untuk brand lain!";
                instructions.style.display = 'block';
                instructions.style.top = "70%";
            }
        }

        // ==================== SPIN BUTTON ====================
        spinBtn.addEventListener('click', () => {
            if (isSpinning) return;

            isSpinning = true;
            spinBtn.disabled = true;
            instructions.style.display = 'none';

            // Show countdown: 3, 2, 1
            let count = 3;
            countdownEl.textContent = count;
            countdownEl.classList.add('active');

            const countdownInterval = setInterval(() => {
                count--;
                if (count > 0) {
                    countdownEl.textContent = count;
                    countdownEl.classList.remove('active');
                    setTimeout(() => countdownEl.classList.add('active'), 10);
                } else {
                    clearInterval(countdownInterval);
                    countdownEl.classList.remove('active');
                    startSpin();
                }
            }, 1000);
        });

        function startSpin() {
            // Speed up the text cycling
            let counter = 0;
            const cycleSpeed = 80; // Change text every 80ms
            const duration = 6000; // Spin for 6 seconds (as requested!)

            const interval = setInterval(() => {
                const randomBrand = brands[Math.floor(Math.random() * brands.length)];
                resultDisplay.innerHTML = `
                <div class="brand-icon">${randomBrand.icon}</div>
                <div>${randomBrand.name}</div>
            `;

                // Change card background color
                card.style.background = `linear-gradient(135deg, ${randomBrand.color}dd, ${randomBrand.color}99)`;
            }, cycleSpeed);

            // Stop logic after 6 seconds
            setTimeout(() => {
                clearInterval(interval);

                // Pick final winner
                const finalWinner = brands[Math.floor(Math.random() * brands.length)];
                resultDisplay.innerHTML = `
                <div class="brand-icon">${finalWinner.icon}</div>
                <div>${finalWinner.name}</div>
            `;

                // Set final card color
                card.style.background = `linear-gradient(135deg, ${finalWinner.color}dd, ${finalWinner.color}99)`;

                // Visual pop effect
                card.classList.add('pulse');
                setTimeout(() => card.classList.remove('pulse'), 500);

                // CONFETTI EFFECT!
                createConfetti();

                // Special message for TAK PUASA
                if (finalWinner.name === "TAK PUASA") {
                    setTimeout(() => {
                        alert('üòÖ Alamak! Tak dapat brand sebab tak puasa tahun ni!\n\nCuba spin lagi untuk brand lain! üåô');
                    }, 800);
                }

                isSpinning = false;
                spinBtn.disabled = false;

                instructions.innerHTML = "üé• RAKAM video sekarang!<br>üåô Spin lagi untuk brand lain";
                instructions.style.display = 'block';
                instructions.style.top = "70%";

            }, duration);
        }

        // ==================== CONFETTI EFFECT ====================
        function createConfetti() {
            const colors = ['#FFD700', '#00A651', '#FFFFFF', '#FF6B00', '#D32F2F'];
            const confettiCount = 80;

            for (let i = 0; i < confettiCount; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.style.position = 'fixed';
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.top = '-20px';
                    confetti.style.width = (Math.random() * 10 + 5) + 'px';
                    confetti.style.height = (Math.random() * 10 + 5) + 'px';
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.opacity = '1';
                    confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
                    confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
                    confetti.style.pointerEvents = 'none';
                    confetti.style.zIndex = '1000';

                    // Add animation
                    const fallDuration = Math.random() * 2 + 2;
                    const spinDuration = Math.random() * 2 + 1;
                    confetti.style.animation = `confettiFall ${fallDuration}s linear, confettiSpin ${spinDuration}s linear`;

                    document.body.appendChild(confetti);

                    // Remove after animation
                    setTimeout(() => {
                        confetti.remove();
                    }, fallDuration * 1000);
                }, i * 20);
            }
        }

        // Add confetti animations to style (dynamically)
        const style = document.createElement('style');
        style.textContent = `
        @keyframes confettiFall {
            to {
                transform: translateY(100vh) translateX(${Math.random() * 200 - 100}px);
                opacity: 0;
            }
        }
        @keyframes confettiSpin {
            to {
                transform: rotate(720deg);
            }
        }
    `;
        document.head.appendChild(style);

        // ==================== KEYBOARD SHORTCUTS ====================
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space' && !isSpinning) {
                e.preventDefault();
                spinBtn.click();
            }
            if (e.code === 'KeyR') {
                e.preventDefault();
                recordBtn.click();
            }
        });
    </script>

</body>

</html>